<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div>hahah</div>
</body>
<script>
    const Work = {
        unit: 10000,
        onOneUnit() {
            for (let i = 0; i < 100000; i++) {
            }
        },
        onSyncUnit() {
            let _u = 0;

            function cb(deadline) {
                // console.log(deadline.timeRemaining(), _u)
                while (deadline.timeRemaining() > 1 && _u <= Work.unit) {
                    Work.onOneUnit()
                    _u++
                }
                if (_u >= Work.unit) {
                    return
                }
                window.requestIdleCallback(cb)
            }

            window.requestIdleCallback(cb)

        }
    }
    Work.onSyncUnit()
</script>
</html>